function ValidateCNPJ(executionContext) {

    // validate that execution context was received
    if (executionContext === null)
        return;

    // declare variable with the execution context content
    formContext = executionContext.getFormContext();

    // declare variable with the CNPJ value entered by the user
    var cnpj = executionContext.getEventSource().getValue();

    var label = executionContext.getEventSource().getName();

    // declare variable isValid as true and validate that the entered CNPJ is not fake,
    // otherwise the variable will receive false
    var isValid = true;
    if (cnpj !== null && cnpj !== "") {
        cnpj = cnpj.replace(/[^\d]+/g, '');
        if (cnpj.length !== 14 ||
            cnpj === "00000000000000" ||
            cnpj === "11111111111111" ||
            cnpj === "22222222222222" ||
            cnpj === "33333333333333" ||
            cnpj === "44444444444444" ||
            cnpj === "55555555555555" ||
            cnpj === "66666666666666" ||
            cnpj === "77777777777777" ||
            cnpj === "88888888888888" ||
            cnpj === "99999999999999") {
            isValid = false;
        }

        var length = cnpj.length - 2;
        var numbers = cnpj.substring(0, length);
        digitos = cnpj.substring(length);
        var sum = 0;
        var pos = length - 7;

        for (i = length; i >= 1; i--) {
            sum += numbers.charAt(length - i) * pos--;
            if (pos < 2)
                pos = 9;
        }

        resultado = sum % 11 < 2 ? 0 : 11 - sum % 11;
        if (resultado.toString() !== digitos.charAt(0)) {
            isValid = false;
        }

        length = length + 1;
        numbers = cnpj.substring(0, length);
        sum = 0;
        pos = length - 7;
        for (i = length; i >= 1; i--) {
            sum += numbers.charAt(length - i) * pos--;
            if (pos < 2)
                pos = 9;
        }
        var resultado = sum % 11 < 2 ? 0 : 11 - sum % 11;
        if (resultado.toString() !== digitos.charAt(1)) {
            isValid = false;
        }
    }
    else {
        isValid = false;
    }

    if (isValid) {
        cnpj = cnpj.substring(0, 2) + '.' + cnpj.substring(2, 5) + '.' + cnpj.substring(5, 8) + '/' + cnpj.substring(8, 12) + '-' + cnpj.substring(12);
        cnpj = formContext.getAttribute(label).setValue(cnpj);
    } else {
        Xrm.Navigation.openAlertDialog({ confirmButtonLabel: "OK", text: "CNPJ " + cnpj + " Invalid" }, { height: 100, width: 300 }).then(
            function success(result) {
                cnpj = formContext.getAttribute(label).setValue("");
                formContext.getAttribute(campoSemFormatacao).setValue("");
            }
        );
    }
}

function ValidateCPF(executionContext) 
{
    if (executionContext === null)
        return;

    var formContext = executionContext.getFormContext();
    var cpf = executionContext.getEventSource().getValue();
    var label = executionContext.getEventSource().getName();

    isValid = true;
    if (cpf !== null && cpf !== "") {
        cpf = cpf.replace(/[^\d]+/g, '');
        var Sum;
        var Remainder;
        Sum = 0;
        if (cpf.length !== 11 ||
            cpf === "00000000000" ||
            cpf === "11111111111" ||
            cpf === "22222222222" ||
            cpf === "33333333333" ||
            cpf === "44444444444" ||
            cpf === "55555555555" ||
            cpf === "66666666666" ||
            cpf === "77777777777" ||
            cpf === "88888888888" ||
            cpf === "99999999999") {
            isValid = false;
        }

        for (i = 1; i <= 9; i++) Sum = Sum + parseInt(cpf.substring(i - 1, i)) * (11 - i);
        Remainder = (Sum * 10) % 11;

        if ((Remainder === 10) || (Remainder === 11)) Remainder = 0;
        if (Remainder !== parseInt(cpf.substring(9, 10))) {
            isValid = false;
        }

        Sum = 0;
        for (i = 1; i <= 10; i++) Sum = Sum + parseInt(cpf.substring(i - 1, i)) * (12 - i);
        Remainder = (Sum * 10) % 11;

        if ((Remainder === 10) || (Remainder === 11)) { Remainder = 0; }
        if (Remainder !== parseInt(cpf.substring(10, 11))) {
            isValid = false;
        }
    }
    else {
        isValid = false;
    }

    if (isValid) {
        cpf = cpf.substring(0, 3) + '.' + cpf.substring(3, 6) + '.' + cpf.substring(6, 9) + '-' + cpf.substring(9);
        cpf = formContext.getAttribute(label).setValue(cpf);
    } else {
        Xrm.Navigation.openAlertDialog({ confirmButtonLabel: "OK", text: "CPF: " + cpf + " - Invalid" }, { height: 100, width: 300 }).then(
            function success(result) {
                cpf = formContext.getAttribute(label).setValue("");
            }
        );
    }
}
